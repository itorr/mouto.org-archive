<!doctype html><title>如果在样式上区分自动换行与 &lt;br&gt; ？ - 代码 - 卜卜口</title><meta name=viewport content=width=device-width,user-scalable=0><link rel=stylesheet href=/static/css/index.css?suffix=1hlsbpv><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black-translucent><link rel=apple-touch-icon-precomposed href=/static/img/projects/mouto.org-icon.svg><link rel=alternate type=application/rss+xml title="卜卜口 RSS 2.0" href=/rss.xml.xml><link rel=manifest href=/manifest.json crossorigin=use-credentials><header><nav><a href=/ ><b>卜卜口</b></a><a href=/projects><b>项目</b></a><a href=/photos?star=1><b>写真</b></a><a href=/notes class=active><b>笔记</b></a><a href=/links><b>链接</b></a></nav></header><div id=M><div class=view-box view=note><div class="article-single-box layout"><div class=head><h1>如果在样式上区分自动换行与 &lt;br&gt; ？</h1><p><a href=/ class=user-link><img src=/static/img/avatar.jpg>卜卜口</a><a href=/photos?type=code>代码</a><time datetime="2018-01-30 10:44:03">2018-1-30</time></div><div class=content><p>以往文章都只有段落和换行两种行间距，对于某些喜欢用换行作为弱等级段落的人来说 自动换行与 <code>&lt;br&gt;</code> 混在一起就很难受?，本文解决的是在样式上区分自动换行与 <code>&lt;br&gt;</code>。<p>一开始尝试了很多不改变 <code>DOM</code> 结构的方向，但 <code>&lt;br&gt;</code> 标签本身和 <code>head</code>、<code>title</code> 不同、虽然在 <code>DOM</code> 树中，但不存在任何样式，作用仅仅是替代 <code>\n</code>? 所以给 <code>&lt;br&gt;</code> 覆盖样式没有任何作用。想要解决这个问题，我的方案还是要动态语言参与改变 <code>DOM</code> 结构才行。<h2>方案</h2><p>输出文章前对 HTML 格式化，在所有 <code>&lt;br&gt;</code> 后添加占位用 <code>&lt;span class=br&gt;</code> 标签；<br><span class=br></span> 自动折行间距通过 <strong>行高 - 字体大小</strong> 进行控制，<code>&lt;br&gt;</code> 换行间距通过 <strong>行高 - 字体大小 + <code>.br</code> 元素高度</strong> 控制。<h2>代码</h2><pre><code class=JavaScript>text=text.replace(/&lt;br\s?\/?&gt;/ig,&#39;&lt;br&gt;&lt;span class=br&gt;&lt;/span&gt;&#39;); 
</code></pre><pre><code class=CSS>.content{ 
&nbsp;&nbsp;&nbsp;&nbsp;line-height:1.8; 
&nbsp;&nbsp;&nbsp;&nbsp;.br{ 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;display:block; 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height:.4em; 
&nbsp;&nbsp;&nbsp;&nbsp;} 
} 
</code></pre><h2>样例</h2><p>可以围观这一篇文字比较多的文章<div class="content-link inset"><a href=/photo/95 target=_blank><img src=//t.magiconch.com/attach/fuukei95/19.jpg!sq512><h4>「吹响！悠风号」圣巡</h4><p>&#x2F;photo&#x2F;95</p><i class=blur-img style=background-image:url(//t.magiconch.com/attach/fuukei95/19.jpg!sq512)></i></a></div></div><div class=cm-article data-key=v3|171></div></div></div></div><script src=/static/js/build.js?suffix=1hlsbpv></script>