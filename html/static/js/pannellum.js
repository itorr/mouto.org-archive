window.libpannellum=function(t,O,oe){"use strict";function n(L){var F,B,T,I,z,H,G,Y,W,X,q,C,Z,j,A,S,V=O.createElement("canvas");function K(e,t){return 1==e.level&&1!=t.level?-1:1==t.level&&1!=e.level?1:t.timestamp-e.timestamp}function J(e,t){return e.level!=t.level?e.level-t.level:e.diff-t.diff}function Q(e,t,a,o,n,i){this.vertices=e,this.side=t,this.level=a,this.x=o,this.y=n,this.path=i.replace("%s",t).replace("%l",a).replace("%x",o).replace("%y",n)}function $(e,t,a,o,n){if(function(e,t){var a=k(e,t.slice(0,3)),o=k(e,t.slice(3,6)),n=k(e,t.slice(6,9)),i=k(e,t.slice(9,12)),r=a[0]+o[0]+n[0]+i[0];if(-4==r||4==r)return!1;var s=a[1]+o[1]+n[1]+i[1];return-4!=s&&4!=s&&a[2]+o[2]+n[2]+i[2]!=4}(e,t.vertices)){var i=t.vertices,r=i[0]+i[3]+i[6]+i[9],s=i[1]+i[4]+i[7]+i[10],l=i[2]+i[5]+i[8]+i[11],h=Math.sqrt(r*r+s*s+l*l),c=Math.asin(l/h),d=Math.atan2(s,r)-o;d+=d>Math.PI?-2*Math.PI:d<-Math.PI?2*Math.PI:0,d=Math.abs(d),t.diff=Math.acos(Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos(d));for(var u=!1,f=0;f<F.nodeCache.length;f++)if(F.nodeCache[f].path==t.path){u=!0,F.nodeCache[f].timestamp=F.nodeCacheTimestamp++,F.nodeCache[f].diff=t.diff,F.currentNodes.push(F.nodeCache[f]);break}if(u||(t.timestamp=F.nodeCacheTimestamp++,F.currentNodes.push(t),F.nodeCache.push(t)),t.level<F.level){var p=W.cubeResolution*Math.pow(2,t.level-W.maxLevel),m=Math.ceil(p*W.invTileResolution)-1,v=p%W.tileResolution*2,g=2*p%W.tileResolution;0===g&&(g=W.tileResolution),0===v&&(v=2*W.tileResolution);var w=.5;t.x!=m&&t.y!=m||(w=1-W.tileResolution/(W.tileResolution+g));var y,b=1-w,x=[],M=w,E=w,P=w,R=b,_=b,L=b;g<W.tileResolution&&(t.x==m&&t.y!=m?(_=E=.5,"d"!=t.side&&"u"!=t.side||(L=P=.5)):t.x!=m&&t.y==m&&(R=M=.5,"l"!=t.side&&"r"!=t.side||(L=P=.5))),v<=W.tileResolution&&(t.x==m&&(M=0,R=1,"l"!=t.side&&"r"!=t.side||(P=0,L=1)),t.y==m&&(E=0,_=1,"d"!=t.side&&"u"!=t.side||(P=0,L=1))),y=new Q([i[0],i[1],i[2],i[0]*M+i[3]*R,i[1]*w+i[4]*b,i[2]*P+i[5]*L,i[0]*M+i[6]*R,i[1]*E+i[7]*_,i[2]*P+i[8]*L,i[0]*w+i[9]*b,i[1]*E+i[10]*_,i[2]*P+i[11]*L],t.side,t.level+1,2*t.x,2*t.y,W.fullpath),x.push(y),t.x==m&&v<=W.tileResolution||(y=new Q([i[0]*M+i[3]*R,i[1]*w+i[4]*b,i[2]*P+i[5]*L,i[3],i[4],i[5],i[3]*w+i[6]*b,i[4]*E+i[7]*_,i[5]*P+i[8]*L,i[0]*M+i[6]*R,i[1]*E+i[7]*_,i[2]*P+i[8]*L],t.side,t.level+1,2*t.x+1,2*t.y,W.fullpath),x.push(y)),t.x==m&&v<=W.tileResolution||t.y==m&&v<=W.tileResolution||(y=new Q([i[0]*M+i[6]*R,i[1]*E+i[7]*_,i[2]*P+i[8]*L,i[3]*w+i[6]*b,i[4]*E+i[7]*_,i[5]*P+i[8]*L,i[6],i[7],i[8],i[9]*M+i[6]*R,i[10]*w+i[7]*b,i[11]*P+i[8]*L],t.side,t.level+1,2*t.x+1,2*t.y+1,W.fullpath),x.push(y)),t.y==m&&v<=W.tileResolution||(y=new Q([i[0]*w+i[9]*b,i[1]*E+i[10]*_,i[2]*P+i[11]*L,i[0]*M+i[6]*R,i[1]*E+i[7]*_,i[2]*P+i[8]*L,i[9]*M+i[6]*R,i[10]*w+i[7]*b,i[11]*P+i[8]*L,i[9],i[10],i[11]],t.side,t.level+1,2*t.x,2*t.y+1,W.fullpath),x.push(y));for(var T=0;T<x.length;T++)$(e,x[T],a,o,n)}}}function ee(e,t,a){var o=Math.sin(t),n=Math.cos(t);return"x"==a?[e[0],n*e[1]+o*e[2],n*e[2]-o*e[1],e[3],n*e[4]+o*e[5],n*e[5]-o*e[4],e[6],n*e[7]+o*e[8],n*e[8]-o*e[7]]:"y"==a?[n*e[0]-o*e[2],e[1],n*e[2]+o*e[0],n*e[3]-o*e[5],e[4],n*e[5]+o*e[3],n*e[6]-o*e[8],e[7],n*e[8]+o*e[6]]:"z"==a?[n*e[0]+o*e[1],n*e[1]-o*e[0],e[2],n*e[3]+o*e[4],n*e[4]-o*e[3],e[5],n*e[6]+o*e[7],n*e[7]-o*e[6],e[8]]:void 0}function te(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]}V.style.width=V.style.height="100%",L.appendChild(V),this.init=function(e,t,a,o,n,i,r,s){if(t===oe&&(t="equirectangular"),"equirectangular"!=t&&"cubemap"!=t&&"multires"!=t)throw console.log("Error: invalid image type specified!"),{type:"config error"};if(X=t,W=e,q=a,S=s||{},F){if(T&&(B.detachShader(F,T),B.deleteShader(T)),I&&(B.detachShader(F,I),B.deleteShader(I)),B.bindBuffer(B.ARRAY_BUFFER,null),B.bindBuffer(B.ELEMENT_ARRAY_BUFFER,null),F.texture&&B.deleteTexture(F.texture),F.nodeCache)for(var l=0;l<F.nodeCache.length;l++)B.deleteTexture(F.nodeCache[l].texture);B.deleteProgram(F),F=oe}var h;Y=oe;var c,d=!1;if("cubemap"==X)for(h=0;h<6;h++)0<W[h].width?(c===oe&&(c=W[h].width),c!=W[h].width&&console.log("Cube faces have inconsistent widths: "+c+" vs. "+W[h].width)):d=!0;function u(e){if(d){var t=e*e*4,a=new Uint8ClampedArray(t),o=s.backgroundColor?s.backgroundColor:[0,0,0];o[0]*=255,o[1]*=255,o[2]*=255;for(var n=0;n<t;n++)a[n++]=o[0],a[n++]=o[1],a[n++]=o[2];var i=new ImageData(a,e,e);for(h=0;h<6;h++)0==W[h].width&&(W[h]=i)}}if("cubemap"==X&&0!=(c&c-1)&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||(B||(B=V.getContext("experimental-webgl",{alpha:!1,depth:!1})),B&&1286==B.getError()&&D()),!B&&("multires"==X&&W.hasOwnProperty("fallbackPath")||"cubemap"==X)&&("WebkitAppearance"in O.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||-1!==navigator.appVersion.indexOf("MSIE 10"))){var f;H&&L.removeChild(H),(H=O.createElement("div")).className="pnlm-world",f=W.basePath?W.basePath+W.fallbackPath:W.fallbackPath;var p=["f","r","b","l","u","d"],m=0,v=function(){var e=O.createElement("canvas");e.className="pnlm-face pnlm-"+p[this.side]+"face",H.appendChild(e);var t=e.getContext("2d");e.style.width=this.width+4+"px",e.style.height=this.height+4+"px",e.width=this.width+4,e.height=this.height+4,t.drawImage(this,2,2);var a,o,n=t.getImageData(0,0,e.width,e.height),i=n.data;for(a=2;a<e.width-2;a++)for(o=0;o<4;o++)i[4*(a+e.width)+o]=i[4*(a+2*e.width)+o],i[4*(a+e.width*(e.height-2))+o]=i[4*(a+e.width*(e.height-3))+o];for(a=2;a<e.height-2;a++)for(o=0;o<4;o++)i[4*(a*e.width+1)+o]=i[4*(a*e.width+2)+o],i[4*((a+1)*e.width-2)+o]=i[4*((a+1)*e.width-3)+o];for(o=0;o<4;o++)i[4*(e.width+1)+o]=i[4*(2*e.width+2)+o],i[4*(2*e.width-2)+o]=i[4*(3*e.width-3)+o],i[4*(e.width*(e.height-2)+1)+o]=i[4*(e.width*(e.height-3)+2)+o],i[4*(e.width*(e.height-1)-2)+o]=i[4*(e.width*(e.height-2)-3)+o];for(a=1;a<e.width-1;a++)for(o=0;o<4;o++)i[4*a+o]=i[4*(a+e.width)+o],i[4*(a+e.width*(e.height-1))+o]=i[4*(a+e.width*(e.height-2))+o];for(a=1;a<e.height-1;a++)for(o=0;o<4;o++)i[a*e.width*4+o]=i[4*(a*e.width+1)+o],i[4*((a+1)*e.width-1)+o]=i[4*((a+1)*e.width-2)+o];for(o=0;o<4;o++)i[o]=i[4*(e.width+1)+o],i[4*(e.width-1)+o]=i[4*(2*e.width-2)+o],i[e.width*(e.height-1)*4+o]=i[4*(e.width*(e.height-2)+1)+o],i[4*(e.width*e.height-1)+o]=i[4*(e.width*(e.height-1)-2)+o];t.putImageData(n,0,0),g.call(this)},g=function(){0<this.width?(z===oe&&(z=this.width),z!=this.width&&console.log("Fallback faces have inconsistent widths: "+z+" vs. "+this.width)):d=!0,6==++m&&(z=this.width,L.appendChild(H),r())};for(d=!1,h=0;h<6;h++){var w=new Image;w.crossOrigin=S.crossOrigin?S.crossOrigin:"anonymous",w.side=h,w.onload=v,w.onerror=g,w.src="multires"==X?encodeURI(f.replace("%s",p[h])+"."+W.extension):encodeURI(W[h].src)}u(z)}else{if(!B)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};"cubemap"==X&&u(c),W.basePath?W.fullpath=W.basePath+W.path:W.fullpath=W.path,W.invTileResolution=1/W.tileResolution;var y=[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1];for(G=[],h=0;h<6;h++)G[h]=y.slice(12*h,12*h+12),y=[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1];var b=0,x=0;if("equirectangular"==X?(b=Math.max(W.width,W.height),x=B.getParameter(B.MAX_TEXTURE_SIZE)):"cubemap"==X&&(b=c,x=B.getParameter(B.MAX_CUBE_MAP_TEXTURE_SIZE)),x<b)throw console.log("Error: The image is too big; it's "+b+"px wide, but this device's maximum supported size is "+x+"px."),{type:"webgl size error",width:b,maxWidth:x};s===oe||s.horizonPitch===oe&&s.horizonRoll===oe||(Y=[s.horizonPitch==oe?0:s.horizonPitch,s.horizonRoll==oe?0:s.horizonRoll]);var M=B.TEXTURE_2D;B.viewport(0,0,B.drawingBufferWidth,B.drawingBufferHeight),T=B.createShader(B.VERTEX_SHADER);var E=N;"multires"==X&&(E=U),B.shaderSource(T,E),B.compileShader(T),I=B.createShader(B.FRAGMENT_SHADER);var P=ie;"cubemap"==X?(M=B.TEXTURE_CUBE_MAP,P=ne):"multires"==X&&(P=re),B.shaderSource(I,P),B.compileShader(I),F=B.createProgram(),B.attachShader(F,T),B.attachShader(F,I),B.linkProgram(F),B.getShaderParameter(T,B.COMPILE_STATUS)||console.log(B.getShaderInfoLog(T)),B.getShaderParameter(I,B.COMPILE_STATUS)||console.log(B.getShaderInfoLog(I)),B.getProgramParameter(F,B.LINK_STATUS)||console.log(B.getProgramInfoLog(F)),B.useProgram(F),F.drawInProgress=!1;var R=s.backgroundColor?s.backgroundColor:[0,0,0];B.clearColor(R[0],R[1],R[2],1),B.clear(B.COLOR_BUFFER_BIT),F.texCoordLocation=B.getAttribLocation(F,"a_texCoord"),B.enableVertexAttribArray(F.texCoordLocation),"multires"!=X?(C||(C=B.createBuffer()),B.bindBuffer(B.ARRAY_BUFFER,C),B.bufferData(B.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),B.STATIC_DRAW),B.vertexAttribPointer(F.texCoordLocation,2,B.FLOAT,!1,0,0),F.aspectRatio=B.getUniformLocation(F,"u_aspectRatio"),B.uniform1f(F.aspectRatio,B.drawingBufferWidth/B.drawingBufferHeight),F.psi=B.getUniformLocation(F,"u_psi"),F.theta=B.getUniformLocation(F,"u_theta"),F.f=B.getUniformLocation(F,"u_f"),F.h=B.getUniformLocation(F,"u_h"),F.v=B.getUniformLocation(F,"u_v"),F.vo=B.getUniformLocation(F,"u_vo"),F.rot=B.getUniformLocation(F,"u_rot"),B.uniform1f(F.h,o/(2*Math.PI)),B.uniform1f(F.v,n/Math.PI),B.uniform1f(F.vo,i/Math.PI*2),"equirectangular"==X&&(F.backgroundColor=B.getUniformLocation(F,"u_backgroundColor"),B.uniform4fv(F.backgroundColor,R.concat([1]))),F.texture=B.createTexture(),B.bindTexture(M,F.texture),"cubemap"==X?(B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W[1]),B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_X,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W[3]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_Y,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W[4]),B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W[5]),B.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_Z,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W[0]),B.texImage2D(B.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W[2])):B.texImage2D(M,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W),B.texParameteri(M,B.TEXTURE_WRAP_S,B.CLAMP_TO_EDGE),B.texParameteri(M,B.TEXTURE_WRAP_T,B.CLAMP_TO_EDGE),B.texParameteri(M,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texParameteri(M,B.TEXTURE_MAG_FILTER,B.LINEAR)):(F.vertPosLocation=B.getAttribLocation(F,"a_vertCoord"),B.enableVertexAttribArray(F.vertPosLocation),Z||(Z=B.createBuffer()),j||(j=B.createBuffer()),A||(A=B.createBuffer()),B.bindBuffer(B.ARRAY_BUFFER,j),B.bufferData(B.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),B.STATIC_DRAW),B.bindBuffer(B.ELEMENT_ARRAY_BUFFER,A),B.bufferData(B.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),B.STATIC_DRAW),F.perspUniform=B.getUniformLocation(F,"u_perspMatrix"),F.cubeUniform=B.getUniformLocation(F,"u_cubeMatrix"),F.level=-1,F.currentNodes=[],F.nodeCache=[],F.nodeCacheTimestamp=0);var _=B.getError();if(0!==_)throw console.log("Error: Something went wrong with WebGL!",_),{type:"webgl error"};r()}},this.destroy=function(){if(L!==oe&&(V!==oe&&L.contains(V)&&L.removeChild(V),H!==oe&&L.contains(H)&&L.removeChild(H)),B){var e=B.getExtension("WEBGL_lose_context");e&&e.loseContext()}},this.resize=function(){var e=t.devicePixelRatio||1;V.width=V.clientWidth*e,V.height=V.clientHeight*e,B&&(1286==B.getError()&&D(),B.viewport(0,0,B.drawingBufferWidth,B.drawingBufferHeight),"multires"!=X&&B.uniform1f(F.aspectRatio,V.clientWidth/V.clientHeight))},this.resize(),this.setPose=function(e,t){Y=[e,t]},this.render=function(e,t,a,o){var n,i,r=0;if(o===oe&&(o={}),o.roll&&(r=o.roll),Y!==oe){var s=Y[0],l=Y[1],h=e,c=t,d=Math.cos(l)*Math.sin(e)*Math.sin(s)+Math.cos(e)*(Math.cos(s)*Math.cos(t)+Math.sin(l)*Math.sin(s)*Math.sin(t)),u=-Math.sin(e)*Math.sin(l)+Math.cos(e)*Math.cos(l)*Math.sin(t),f=Math.cos(l)*Math.cos(s)*Math.sin(e)+Math.cos(e)*(-Math.cos(t)*Math.sin(s)+Math.cos(s)*Math.sin(l)*Math.sin(t));e=Math.asin(Math.max(Math.min(f,1),-1)),t=Math.atan2(u,d);var p=[Math.cos(h)*(Math.sin(l)*Math.sin(s)*Math.cos(c)-Math.cos(s)*Math.sin(c)),Math.cos(h)*Math.cos(l)*Math.cos(c),Math.cos(h)*(Math.cos(s)*Math.sin(l)*Math.cos(c)+Math.sin(c)*Math.sin(s))],m=[-Math.cos(e)*Math.sin(t),Math.cos(e)*Math.cos(t)],v=Math.acos(Math.max(Math.min((p[0]*m[0]+p[1]*m[1])/(Math.sqrt(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*Math.sqrt(m[0]*m[0]+m[1]*m[1])),1),-1));p[2]<0&&(v=2*Math.PI-v),r+=v}if(B||"multires"!=X&&"cubemap"!=X){if("multires"!=X){var g=2*Math.atan(Math.tan(.5*a)/(B.drawingBufferWidth/B.drawingBufferHeight));n=1/Math.tan(.5*g),B.uniform1f(F.psi,t),B.uniform1f(F.theta,e),B.uniform1f(F.rot,r),B.uniform1f(F.f,n),!0===q&&"equirectangular"==X&&(B.bindTexture(B.TEXTURE_2D,F.texture),B.texImage2D(B.TEXTURE_2D,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,W)),B.drawArrays(B.TRIANGLES,0,6)}else{var w=(L=a,T=B.drawingBufferWidth/B.drawingBufferHeight,I=.1,C=100,A=2*Math.atan(Math.tan(L/2)*B.drawingBufferHeight/B.drawingBufferWidth),[(S=1/Math.tan(A/2))/T,0,0,0,0,S,0,0,0,0,(C+I)/(I-C),2*C*I/(I-C),0,0,-1,0]);!function(e){var t=1;for(;t<W.maxLevel&&B.drawingBufferWidth>W.tileResolution*Math.pow(2,t-1)*Math.tan(e/2)*.707;)t++;F.level=t}(a);var y=[1,0,0,0,1,0,0,0,1];y=ee(y=ee(y=ee(y,-r,"z"),-e,"x"),t,"y"),y=[(_=y)[0],_[1],_[2],0,_[3],_[4],_[5],0,_[6],_[7],_[8],0,0,0,0,1],B.uniformMatrix4fv(F.perspUniform,!1,new Float32Array(te(w))),B.uniformMatrix4fv(F.cubeUniform,!1,new Float32Array(te(y)));var b=[(P=w)[0]*(R=y)[0],P[0]*R[1],P[0]*R[2],0,P[5]*R[4],P[5]*R[5],P[5]*R[6],0,P[10]*R[8],P[10]*R[9],P[10]*R[10],P[11],-R[8],-R[9],-R[10],0];if(F.nodeCache.sort(K),200<F.nodeCache.length&&F.nodeCache.length>F.currentNodes.length+50)for(var x=F.nodeCache.splice(200,F.nodeCache.length-200),M=0;M<x.length;M++)B.deleteTexture(x[M].texture);F.currentNodes=[];var E=["f","b","u","d","l","r"];for(i=0;i<6;i++){$(b,new Q(G[i],E[i],1,0,0,W.fullpath),e,t,a)}for(F.currentNodes.sort(J),M=0;M<F.currentNodes.length;M++)if(!F.currentNodes[M].texture){setTimeout(ae,0,F.currentNodes[M]);break}!function(){if(!F.drawInProgress){F.drawInProgress=!0,B.clear(B.COLOR_BUFFER_BIT);for(var e=0;e<F.currentNodes.length;e++)1<F.currentNodes[e].textureLoaded&&(B.bindBuffer(B.ARRAY_BUFFER,Z),B.bufferData(B.ARRAY_BUFFER,new Float32Array(F.currentNodes[e].vertices),B.STATIC_DRAW),B.vertexAttribPointer(F.vertPosLocation,3,B.FLOAT,!1,0,0),B.bindBuffer(B.ARRAY_BUFFER,j),B.vertexAttribPointer(F.texCoordLocation,2,B.FLOAT,!1,0,0),B.bindTexture(B.TEXTURE_2D,F.currentNodes[e].texture),B.drawElements(B.TRIANGLES,6,B.UNSIGNED_SHORT,0));F.drawInProgress=!1}}()}var P,R,_,L,T,I,C,A,S;if(o.returnImage!==oe)return V.toDataURL("image/png")}else{var k={f:"translate3d(-"+((i=z/2)+2)+"px, -"+(i+2)+"px, -"+i+"px)",b:"translate3d("+(i+2)+"px, -"+(i+2)+"px, "+i+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(i+2)+"px, -"+i+"px, "+(i+2)+"px) rotateX(270deg)",d:"translate3d(-"+(i+2)+"px, "+i+"px, -"+(i+2)+"px) rotateX(90deg)",l:"translate3d(-"+i+"px, -"+(i+2)+"px, "+(i+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+i+"px, -"+(i+2)+"px, -"+(i+2)+"px) rotateY(270deg)"},D=(n=1/Math.tan(a/2))*V.clientWidth/2+"px",O="perspective("+D+") translateZ("+D+") rotateX("+e+"rad) rotateY("+t+"rad) ",N=Object.keys(k);for(M=0;M<6;M++){var U=H.querySelector(".pnlm-"+N[M]+"face");U&&(U.style.webkitTransform=O+k[N[M]],U.style.transform=O+k[N[M]])}}},this.isLoading=function(){if(B&&"multires"==X)for(var e=0;e<F.currentNodes.length;e++)if(!F.currentNodes[e].textureLoaded)return!0;return!1},this.getCanvas=function(){return V};var e=function(){var n,i=4,r={},s=[];function e(){var a=this;this.texture=this.callback=null,this.image=new Image,this.image.crossOrigin=n||"anonymous";var e=function(){var e,t;0<a.image.width&&0<a.image.height?(e=a.image,t=a.texture,B.bindTexture(B.TEXTURE_2D,t),B.texImage2D(B.TEXTURE_2D,0,B.RGB,B.RGB,B.UNSIGNED_BYTE,e),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MAG_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_MIN_FILTER,B.LINEAR),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_S,B.CLAMP_TO_EDGE),B.texParameteri(B.TEXTURE_2D,B.TEXTURE_WRAP_T,B.CLAMP_TO_EDGE),B.bindTexture(B.TEXTURE_2D,null),a.callback(a.texture,!0)):a.callback(a.texture,!1),function(e){if(s.length){var t=s.shift();e.loadTexture(t.src,t.texture,t.callback)}else r[i++]=e}(a)};this.image.addEventListener("load",e),this.image.addEventListener("error",e)}function l(e,t,a){this.src=e,this.texture=t,this.callback=a}e.prototype.loadTexture=function(e,t,a){this.texture=t,this.callback=a,this.image.src=e};for(var t=0;t<i;t++)r[t]=new e;return function(e,t,a){n=a;var o=B.createTexture();return i?r[--i].loadTexture(e,o,t):s.push(new l(e,o,t)),o}}();function ae(a){a.textureLoad||(a.textureLoad=!0,e(encodeURI(a.path+"."+W.extension),function(e,t){a.texture=e,a.textureLoaded=t?2:1},S.crossOrigin))}function k(e,t){var a,o,n=(o=t,[(a=e)[0]*o[0]+a[1]*o[1]+a[2]*o[2],a[4]*o[0]+a[5]*o[1]+a[6]*o[2],a[11]+a[8]*o[0]+a[9]*o[1]+a[10]*o[2],1/(a[12]*o[0]+a[13]*o[1]+a[14]*o[2])]),i=n[0]*n[3],r=n[1]*n[3],s=n[2]*n[3],l=[0,0,0];return i<-1&&(l[0]=-1),1<i&&(l[0]=1),r<-1&&(l[1]=-1),1<r&&(l[1]=1),(s<-1||1<s)&&(l[2]=1),l}function D(){console.log("Reducing canvas size due to error 1286!"),V.width=Math.round(V.width/2),V.height=Math.round(V.height/2)}}var N=["attribute vec2 a_texCoord;","varying vec2 v_texCoord;","void main() {","gl_Position = vec4(a_texCoord, 0.0, 1.0);","v_texCoord = a_texCoord;","}"].join(""),U=["attribute vec3 a_vertCoord;","attribute vec2 a_texCoord;","uniform mat4 u_cubeMatrix;","uniform mat4 u_perspMatrix;","varying mediump vec2 v_texCoord;","void main(void) {","gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);","v_texCoord = a_texCoord;","}"].join(""),e=["precision mediump float;","uniform float u_aspectRatio;","uniform float u_psi;","uniform float u_theta;","uniform float u_f;","uniform float u_h;","uniform float u_v;","uniform float u_vo;","uniform float u_rot;","const float PI = 3.14159265358979323846264;","uniform sampler2D u_image;","uniform samplerCube u_imageCube;","varying vec2 v_texCoord;","uniform vec4 u_backgroundColor;","void main() {","float x = v_texCoord.x * u_aspectRatio;","float y = v_texCoord.y;","float sinrot = sin(u_rot);","float cosrot = cos(u_rot);","float rot_x = x * cosrot - y * sinrot;","float rot_y = x * sinrot + y * cosrot;","float sintheta = sin(u_theta);","float costheta = cos(u_theta);","float a = u_f * costheta - rot_y * sintheta;","float root = sqrt(rot_x * rot_x + a * a);","float lambda = atan(rot_x / root, a / root) + u_psi;","float phi = atan((rot_y * costheta + u_f * sintheta) / root);"].join("\n"),ne=e+["float cosphi = cos(phi);","gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));","}"].join("\n"),ie=e+["lambda = mod(lambda + PI, PI * 2.0) - PI;","vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));","if(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)","gl_FragColor = u_backgroundColor;","else","gl_FragColor = texture2D(u_image, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));","}"].join("\n"),re=["varying mediump vec2 v_texCoord;","uniform sampler2D u_sampler;","void main(void) {","gl_FragColor = texture2D(u_sampler, v_texCoord);","}"].join("");return{renderer:function(e,t,a,o){return new n(e,t,a,o)}}}(window,document),window.pannellum=function(Ne,Ue,Fe){"use strict";function a(o,c){var v,g,i,f,h,p,t,s,d,a=this,u=!1,m=Date.now(),w=0,y=0,b=-1,x=0,M=0,E=new Array(10),n=!1,r=!1,e=!1,P={yaw:0,pitch:0,hfov:0},l=!1,R=!1,_=0,L=0,T={},I={},C=[],A=!1,S=!1,k={hfov:100,minHfov:50,maxHfov:120,pitch:0,minPitch:Fe,maxPitch:Fe,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:Fe,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,doubleClickZoom:!0,keyboardZoom:!0,mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0],avoidShowingBackground:!1,animationTimingFunction:function(e){return e<.5?2*e*e:(4-2*e)*e-1},draggable:!0,disableKeyboardCtrl:!1,crossOrigin:"anonymous",touchPanSpeedCoeffFactor:1,capturedKeyNumbers:[16,17,27,37,38,39,40,61,65,68,83,87,107,109,173,187,189],strings:{loadButtonLabel:"点击加载全景图",loadingLabel:"加载中...",bylineLabel:"by %s",noPanoramaError:"No panorama image was specified.",fileAccessError:"The file %s could not be accessed.",malformedURLError:"There is something wrong with the panorama URL.",iOS8WebGLError:"Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).",genericWebGLError:"Your browser does not have the necessary WebGL support to display this panorama.",textureSizeError:"This panorama is too big for your device! It's %spx wide, but your device only supports images up to %spx wide. Try another device. (If you're the author, try scaling down the image.)",unknownError:"Unknown error. Check developer console."}};(o="string"==typeof o?Ue.getElementById(o):o).classList.add("pnlm-container"),o.tabIndex=0;var D=Ue.createElement("div");D.className="pnlm-ui",o.appendChild(D);var O=Ue.createElement("div");O.className="pnlm-render-container",o.appendChild(O);var N=Ue.createElement("div");N.className="pnlm-dragfix",D.appendChild(N),N.addEventListener("contextmenu",function(e){e.preventDefault()});var U={},F=Ue.createElement("div");F.className="pnlm-sprite pnlm-hot-spot-debug-indicator",D.appendChild(F),U.container=Ue.createElement("div"),U.container.className="pnlm-panorama-info",U.title=Ue.createElement("div"),U.title.className="pnlm-title-box",U.container.appendChild(U.title),U.author=Ue.createElement("div"),U.author.className="pnlm-author-box",U.container.appendChild(U.author),D.appendChild(U.container),U.load={},U.load.box=Ue.createElement("div"),U.load.box.className="pnlm-load-box",U.load.boxp=Ue.createElement("p"),U.load.box.appendChild(U.load.boxp),U.load.lbox=Ue.createElement("div"),U.load.lbox.className="pnlm-lbox",U.load.lbox.innerHTML='<div class="pnlm-loading"></div>',U.load.box.appendChild(U.load.lbox),U.load.lbar=Ue.createElement("div"),U.load.lbar.className="pnlm-lbar",U.load.lbarFill=Ue.createElement("div"),U.load.lbarFill.className="pnlm-lbar-fill",U.load.lbar.appendChild(U.load.lbarFill),U.load.box.appendChild(U.load.lbar),U.load.msg=Ue.createElement("p"),U.load.msg.className="pnlm-lmsg",U.load.box.appendChild(U.load.msg),D.appendChild(U.load.box),U.errorMsg=Ue.createElement("div"),U.errorMsg.className="pnlm-error-msg pnlm-info-box",D.appendChild(U.errorMsg);var B={};B.container=Ue.createElement("div"),B.container.className="pnlm-controls-container",D.appendChild(B.container),B.load=Ue.createElement("div"),B.load.className="pnlm-load-button",B.load.addEventListener("click",function(){Pe(),Ce()}),D.appendChild(B.load),B.zoom=Ue.createElement("div"),B.zoom.className="pnlm-zoom-controls pnlm-controls",B.zoomIn=Ue.createElement("div"),B.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control",B.zoomIn.addEventListener("click",function(){f&&(Te(v.hfov-5),pe())}),B.zoom.appendChild(B.zoomIn),B.zoomOut=Ue.createElement("div"),B.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control",B.zoomOut.addEventListener("click",function(){f&&(Te(v.hfov+5),pe())}),B.zoom.appendChild(B.zoomOut),B.container.appendChild(B.zoom),B.fullscreen=Ue.createElement("div"),B.fullscreen.addEventListener("click",Re),B.fullscreen.className="pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control",(Ue.fullscreenEnabled||Ue.mozFullScreenEnabled||Ue.webkitFullscreenEnabled||Ue.msFullscreenEnabled)&&B.container.appendChild(B.fullscreen),B.orientation=Ue.createElement("div"),B.orientation.addEventListener("click",function(e){R?Se():ke()}),B.orientation.addEventListener("mousedown",function(e){e.stopPropagation()}),B.orientation.addEventListener("touchstart",function(e){e.stopPropagation()}),B.orientation.addEventListener("pointerdown",function(e){e.stopPropagation()});var z,H=!(B.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control");Ne.DeviceOrientationEvent?Ne.addEventListener("deviceorientation",function e(t){Ne.removeEventListener("deviceorientation",e),t&&null!==t.alpha&&null!==t.beta&&null!==t.gamma?(B.container.appendChild(B.orientation),z=!0,H&&ke()):z=!1}):z=!1;var G=Ue.createElement("div");function Y(){var e=Ue.createElement("div");if(e.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e",1!=e.getElementsByTagName("i").length){var t,a;if(s=v.hfov,d=v.pitch,"cubemap"==v.type){for(h=[],t=0;t<6;t++)h.push(new Image),h[t].crossOrigin=v.crossOrigin;U.load.lbox.style.display="block",U.load.lbar.style.display="none"}else if("multires"==v.type){var o=JSON.parse(JSON.stringify(v.multiRes));v.basePath&&v.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(v.multiRes.basePath)?o.basePath=v.basePath+v.multiRes.basePath:v.multiRes.basePath?o.basePath=v.multiRes.basePath:v.basePath&&(o.basePath=v.basePath),h=o}else if(!0===v.dynamic)h=v.panorama;else{if(v.panorama===Fe)return void q(v.strings.noPanoramaError);h=new Image}if("cubemap"==v.type){var n=6,i=function(){0===--n&&X()},r=function(e){var t=Ue.createElement("a");t.href=e.target.src,t.innerHTML=t.href,q(v.strings.fileAccessError.replace("%s",t.outerHTML))};for(t=0;t<h.length;t++)"null"==(a=v.cubeMap[t])?(console.log("Will use background instead of missing cubemap face "+t),i()):(v.basePath&&!W(a)&&(a=v.basePath+a),h[t].onload=i,h[t].onerror=r,h[t].src=encodeURI(a))}else if("multires"==v.type)X();else if(a="",v.basePath&&(a=v.basePath),!0!==v.dynamic){a=W(v.panorama)?v.panorama:a+v.panorama,h.onload=function(){Ne.URL.revokeObjectURL(this.src),X()};var l=new XMLHttpRequest;l.onloadend=function(){if(200!=l.status){var e=Ue.createElement("a");e.href=encodeURI(a),e.innerHTML=e.href,q(v.strings.fileAccessError.replace("%s",e.outerHTML))}var r,s,t=this.response;r=t,(s=new FileReader).addEventListener("loadend",function(){var e=s.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var t=e.indexOf("ÿÂ");(t<0||65536<t)&&q(v.strings.iOS8WebGLError)}var a=e.indexOf("<x:xmpmeta");if(-1<a&&!0!==v.ignoreGPanoXMP){var o=e.substring(a,e.indexOf("</x:xmpmeta>")+12),n=function(e){var t;return 0<=o.indexOf(e+'="')?t=(t=o.substring(o.indexOf(e+'="')+e.length+2)).substring(0,t.indexOf('"')):0<=o.indexOf(e+">")&&(t=(t=o.substring(o.indexOf(e+">")+e.length+1)).substring(0,t.indexOf("<"))),t!==Fe?Number(t):null},i={fullWidth:n("GPano:FullPanoWidthPixels"),croppedWidth:n("GPano:CroppedAreaImageWidthPixels"),fullHeight:n("GPano:FullPanoHeightPixels"),croppedHeight:n("GPano:CroppedAreaImageHeightPixels"),topPixels:n("GPano:CroppedAreaTopPixels"),heading:n("GPano:PoseHeadingDegrees"),horizonPitch:n("GPano:PosePitchDegrees"),horizonRoll:n("GPano:PoseRollDegrees")};null!==i.fullWidth&&null!==i.croppedWidth&&null!==i.fullHeight&&null!==i.croppedHeight&&null!==i.topPixels&&(C.indexOf("haov")<0&&(v.haov=i.croppedWidth/i.fullWidth*360),C.indexOf("vaov")<0&&(v.vaov=i.croppedHeight/i.fullHeight*180),C.indexOf("vOffset")<0&&(v.vOffset=-180*((i.topPixels+i.croppedHeight/2)/i.fullHeight-.5)),null!==i.heading&&C.indexOf("northOffset")<0&&(v.northOffset=i.heading,!1!==v.compass&&(v.compass=!0)),null!==i.horizonPitch&&null!==i.horizonRoll&&(C.indexOf("horizonPitch")<0&&(v.horizonPitch=i.horizonPitch),C.indexOf("horizonRoll")<0&&(v.horizonRoll=i.horizonRoll)))}h.src=Ne.URL.createObjectURL(r)}),s.readAsBinaryString!==Fe?s.readAsBinaryString(r):s.readAsText(r),U.load.msg.innerHTML=""},l.onprogress=function(e){if(e.lengthComputable){var t,a,o,n=e.loaded/e.total*100;U.load.lbarFill.style.width=n+"%",1e6<e.total?(t="MB",a=(e.loaded/1e6).toFixed(2),o=(e.total/1e6).toFixed(2)):1e3<e.total?(t="kB",a=(e.loaded/1e3).toFixed(1),o=(e.total/1e3).toFixed(1)):(t="B",a=e.loaded,o=e.total),U.load.msg.innerHTML=a+" / "+o+" "+t}else U.load.lbox.style.display="block",U.load.lbar.style.display="none"};try{l.open("GET",a,!0)}catch(e){q(v.strings.malformedURLError)}l.responseType="blob",l.setRequestHeader("Accept","image/*,*/*;q=0.9"),l.withCredentials="use-credentials"===v.crossOrigin,l.send()}v.draggable&&D.classList.add("pnlm-grab"),D.classList.remove("pnlm-grabbing")}else q()}function W(e){return new RegExp("^(?:[a-z]+:)?//","i").test(e)||"/"==e[0]||"blob:"==e.slice(0,5)}function X(){g||(g=new libpannellum.renderer(O)),e||(e=!0,N.addEventListener("mousedown",j,!1),Ue.addEventListener("mousemove",J,!1),Ue.addEventListener("mouseup",Q,!1),v.mouseZoom&&(D.addEventListener("mousewheel",se,!1),D.addEventListener("DOMMouseScroll",se,!1)),v.doubleClickZoom&&N.addEventListener("dblclick",V,!1),D.addEventListener("mozfullscreenchange",_e,!1),D.addEventListener("webkitfullscreenchange",_e,!1),D.addEventListener("msfullscreenchange",_e,!1),D.addEventListener("fullscreenchange",_e,!1),Ne.addEventListener("resize",fe,!1),Ne.addEventListener("orientationchange",fe,!1),v.disableKeyboardCtrl||(o.addEventListener("keydown",le,!1),o.addEventListener("keyup",ce,!1),o.addEventListener("blur",he,!1)),Ue.addEventListener("mouseleave",Q,!1),""===Ue.documentElement.style.pointerAction&&""===Ue.documentElement.style.touchAction?(N.addEventListener("pointerdown",ne,!1),N.addEventListener("pointermove",ie,!1),N.addEventListener("pointerup",re,!1),N.addEventListener("pointerleave",re,!1)):(N.addEventListener("touchstart",$,!1),N.addEventListener("touchmove",ee,!1),N.addEventListener("touchend",te,!1)),Ne.navigator.pointerEnabled&&(o.style.touchAction="none")),function(){try{var e={};v.horizonPitch!==Fe&&(e.horizonPitch=v.horizonPitch*Math.PI/180),v.horizonRoll!==Fe&&(e.horizonRoll=v.horizonRoll*Math.PI/180),v.backgroundColor!==Fe&&(e.backgroundColor=v.backgroundColor),g.init(h,v.type,v.dynamic,v.haov*Math.PI/180,v.vaov*Math.PI/180,v.vOffset*Math.PI/180,ye,e),!0!==v.dynamic&&(h=Fe)}catch(e){if("webgl error"==e.type||"no webgl"==e.type)q();else{if("webgl size error"!=e.type)throw q(v.strings.unknownError),e;q(v.strings.textureSizeError.replace("%s",e.width).replace("%s",e.maxWidth))}}}(),Te(v.hfov),setTimeout(function(){!0},500)}function q(e){e===Fe&&(e=v.strings.genericWebGLError),U.errorMsg.innerHTML="<p>"+e+"</p>",B.load.style.display="none",U.load.box.style.display="none",U.errorMsg.style.display="table",r=!0,O.style.display="none",Oe("error",e)}function Z(e){var t=o.getBoundingClientRect(),a={};return a.x=e.clientX-t.left,a.y=e.clientY-t.top,a}function j(e){if(e.preventDefault(),o.focus(),f&&v.draggable){var t=Z(e);if(v.hotSpotDebug){var a=K(e);console.log("Pitch: "+a[0]+", Yaw: "+a[1]+", Center Pitch: "+v.pitch+", Center Yaw: "+v.yaw+", HFOV: "+v.hfov)}Ie(),Se(),v.roll=0,P.hfov=0,u=!0,m=Date.now(),w=t.x,y=t.y,x=v.yaw,M=v.pitch,D.classList.add("pnlm-grabbing"),D.classList.remove("pnlm-grab"),Oe("mousedown",e),pe()}}function V(e){if(v.minHfov===v.hfov)a.setHfov(s,1e3);else{var t=K(e);a.lookAt(t[0],t[1],v.minHfov,1e3)}}function K(e){var t=Z(e),a=g.getCanvas(),o=a.clientWidth,n=a.clientHeight,i=t.x/o*2-1,r=(1-t.y/n*2)*n/o,s=1/Math.tan(v.hfov*Math.PI/360),l=Math.sin(v.pitch*Math.PI/180),h=Math.cos(v.pitch*Math.PI/180),c=s*h-r*l,d=Math.sqrt(i*i+c*c),u=180*Math.atan((r*h+s*l)/d)/Math.PI,f=180*Math.atan2(i/d,c/d)/Math.PI+v.yaw;return f<-180&&(f+=360),180<f&&(f-=360),[u,f]}function J(e){if(u&&f){m=Date.now();var t=g.getCanvas(),a=t.clientWidth,o=t.clientHeight,n=Z(e),i=180*(Math.atan(w/a*2-1)-Math.atan(n.x/a*2-1))/Math.PI*v.hfov/90+x;P.yaw=(i-v.yaw)%360*.2,v.yaw=i;var r=2*Math.atan(Math.tan(v.hfov/360*Math.PI)*o/a)*180/Math.PI,s=180*(Math.atan(n.y/o*2-1)-Math.atan(y/o*2-1))/Math.PI*r/90+M;P.pitch=.2*(s-v.pitch),v.pitch=s}}function Q(e){u&&(u=!1,15<Date.now()-m&&(P.pitch=P.yaw=0),D.classList.add("pnlm-grab"),D.classList.remove("pnlm-grabbing"),m=Date.now(),Oe("mouseup",e))}function $(e){if(f&&v.draggable){Ie(),Se(),v.roll=0,P.hfov=0;var t=Z(e.targetTouches[0]);if(w=t.x,y=t.y,2==e.targetTouches.length){var a=Z(e.targetTouches[1]);w+=.5*(a.x-t.x),y+=.5*(a.y-t.y),b=Math.sqrt((t.x-a.x)*(t.x-a.x)+(t.y-a.y)*(t.y-a.y))}u=!0,m=Date.now(),x=v.yaw,M=v.pitch,Oe("touchstart",e),pe()}}function ee(e){if(v.draggable&&(e.preventDefault(),f&&(m=Date.now()),u&&f)){var t=Z(e.targetTouches[0]),a=t.x,o=t.y;if(2==e.targetTouches.length&&-1!=b){var n=Z(e.targetTouches[1]);a+=.5*(n.x-t.x),o+=.5*(n.y-t.y);var i=Math.sqrt((t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y));Te(v.hfov+.1*(b-i)),b=i}var r=v.hfov/360*v.touchPanSpeedCoeffFactor,s=(w-a)*r+x;P.yaw=(s-v.yaw)%360*.2,v.yaw=s;var l=(o-y)*r+M;P.pitch=.2*(l-v.pitch),v.pitch=l}}function te(){u=!1,150<Date.now()-m&&(P.pitch=P.yaw=0),b=-1,m=Date.now(),Oe("touchend",event)}G.className="pnlm-compass pnlm-controls pnlm-control",D.appendChild(G),c.firstScene?Ee(c.firstScene):c.default&&c.default.firstScene?Ee(c.default.firstScene):Ee(null),Pe(!0);var ae=[],oe=[];function ne(e){"touch"==e.pointerType&&(ae.push(e.pointerId),oe.push({clientX:e.clientX,clientY:e.clientY}),e.targetTouches=oe,$(e),e.preventDefault())}function ie(e){if("touch"==e.pointerType)for(var t=0;t<ae.length;t++)if(e.pointerId==ae[t])return oe[t].clientX=e.clientX,oe[t].clientY=e.clientY,e.targetTouches=oe,ee(e),void e.preventDefault()}function re(e){if("touch"==e.pointerType){for(var t=!1,a=0;a<ae.length;a++)e.pointerId==ae[a]&&(ae[a]=Fe),ae[a]&&(t=!0);t||(ae=[],oe=[],te()),e.preventDefault()}}function se(e){f&&("fullscreenonly"!=v.mouseZoom||n)&&(e.preventDefault(),Ie(),m=Date.now(),e.wheelDeltaY?(Te(v.hfov-.05*e.wheelDeltaY),P.hfov=e.wheelDelta<0?1:-1):e.wheelDelta?(Te(v.hfov-.05*e.wheelDelta),P.hfov=e.wheelDelta<0?1:-1):e.detail&&(Te(v.hfov+1.5*e.detail),P.hfov=0<e.detail?1:-1),pe())}function le(e){Ie(),m=Date.now(),Se(),v.roll=0;var t=e.which||e.keycode;v.capturedKeyNumbers.indexOf(t)<0||(e.preventDefault(),27==t?n&&Re():de(t,!0))}function he(){for(var e=0;e<10;e++)E[e]=!1}function ce(e){var t=e.which||e.keycode;v.capturedKeyNumbers.indexOf(t)<0||(e.preventDefault(),de(t,!1))}function de(e,t){var a=!1;switch(e){case 109:case 189:case 17:case 173:E[0]!=t&&(a=!0),E[0]=t;break;case 107:case 187:case 16:case 61:E[1]!=t&&(a=!0),E[1]=t;break;case 38:E[2]!=t&&(a=!0),E[2]=t;break;case 87:E[6]!=t&&(a=!0),E[6]=t;break;case 40:E[3]!=t&&(a=!0),E[3]=t;break;case 83:E[7]!=t&&(a=!0),E[7]=t;break;case 37:E[4]!=t&&(a=!0),E[4]=t;break;case 65:E[8]!=t&&(a=!0),E[8]=t;break;case 39:E[5]!=t&&(a=!0),E[5]=t;break;case 68:E[9]!=t&&(a=!0),E[9]=t}a&&t&&(p="undefined"!=typeof performance&&performance.now()?performance.now():Date.now(),pe())}function ue(e){var t=T[e],a=Math.min(1,Math.max((Date.now()-t.startTime)/1e3/(t.duration/1e3),0)),o=t.startPosition+v.animationTimingFunction(a)*(t.endPosition-t.startPosition);if(t.endPosition>t.startPosition&&o>=t.endPosition||t.endPosition<t.startPosition&&o<=t.endPosition||t.endPosition===t.startPosition){o=t.endPosition,P[e]=0;var n=T[e].callback,i=T[e].callbackArgs;delete T[e],"function"==typeof n&&n(i)}v[e]=o}function fe(){_e()}function pe(){l||(l=!0,me())}function me(){if(function(){var e;if(f){180<v.yaw?v.yaw-=360:v.yaw<-180&&(v.yaw+=360),e=v.yaw;var t=0;if(v.avoidShowingBackground){var a=g.getCanvas(),o=v.hfov/2,n=180*Math.atan2(Math.tan(o/180*Math.PI),a.width/a.height)/Math.PI,i=v.vaov>v.haov;i?n*(1-Math.min(Math.cos((v.pitch-o)/180*Math.PI),Math.cos((v.pitch+o)/180*Math.PI))):t=o*(1-Math.min(Math.cos((v.pitch-n)/180*Math.PI),Math.cos((v.pitch+n)/180*Math.PI)))}var r=v.maxYaw-v.minYaw,s=-180,l=180;r<360&&(s=v.minYaw+v.hfov/2+t,l=v.maxYaw-v.hfov/2-t,r<v.hfov&&(s=l=(s+l)/2),v.yaw=Math.max(s,Math.min(l,v.yaw))),!1!==v.autoRotate&&e!=v.yaw&&p!==Fe&&(v.autoRotate*=-1);var a=g.getCanvas(),h=2*Math.atan(Math.tan(v.hfov/180*Math.PI*.5)/(a.width/a.height))/Math.PI*180,c=v.minPitch+h/2,d=v.maxPitch-h/2,u=v.maxPitch-v.minPitch;u<h&&(c=d=(c+d)/2),isNaN(c)&&(c=-90),isNaN(d)&&(d=90),v.pitch=Math.max(c,Math.min(d,v.pitch)),g.render(v.pitch*Math.PI/180,v.yaw*Math.PI/180,v.hfov*Math.PI/180,{roll:v.roll*Math.PI/180}),Me(),v.compass&&(G.style.transform="rotate("+(-v.yaw-v.northOffset)+"deg)",G.style.webkitTransform="rotate("+(-v.yaw-v.northOffset)+"deg)")}}(),t&&clearTimeout(t),u||!0===R)requestAnimationFrame(me);else if(E[0]||E[1]||E[2]||E[3]||E[4]||E[5]||E[6]||E[7]||E[8]||E[9]||v.autoRotate||T.pitch||T.yaw||T.hfov||.01<Math.abs(P.yaw)||.01<Math.abs(P.pitch)||.01<Math.abs(P.hfov))!function(){if(f){var e,t=!1,a=v.pitch,o=v.yaw,n=v.hfov;e="undefined"!=typeof performance&&performance.now()?performance.now():Date.now(),p===Fe&&(p=e);var i=(e-p)*v.hfov/1700;if(i=Math.min(i,1),E[0]&&!0===v.keyboardZoom&&(Te(v.hfov+(.8*P.hfov+.5)*i),t=!0),E[1]&&!0===v.keyboardZoom&&(Te(v.hfov+(.8*P.hfov-.2)*i),t=!0),(E[2]||E[6])&&(v.pitch+=(.8*P.pitch+.2)*i,t=!0),(E[3]||E[7])&&(v.pitch+=(.8*P.pitch-.2)*i,t=!0),(E[4]||E[8])&&(v.yaw+=(.8*P.yaw-.2)*i,t=!0),(E[5]||E[9])&&(v.yaw+=(.8*P.yaw+.2)*i,t=!0),t&&(m=Date.now()),Date.now(),v.autoRotate){if(.001<e-p){var r=(e-p)/1e3,s=(P.yaw/r*i-.2*v.autoRotate)*r;s=(0<-v.autoRotate?1:-1)*Math.min(Math.abs(v.autoRotate*r),Math.abs(s)),v.yaw+=s}v.autoRotateStopDelay&&(v.autoRotateStopDelay-=e-p,v.autoRotateStopDelay<=0&&(v.autoRotateStopDelay=!1,L=v.autoRotate,v.autoRotate=0))}if(T.pitch&&(ue("pitch"),a=v.pitch),T.yaw&&(ue("yaw"),o=v.yaw),T.hfov&&(ue("hfov"),n=v.hfov),0<i&&!v.autoRotate&&(E[4]||E[5]||E[8]||E[9]||T.yaw||(v.yaw+=P.yaw*i*.85),E[2]||E[3]||E[6]||E[7]||T.pitch||(v.pitch+=P.pitch*i*.85),E[0]||E[1]||T.hfov||Te(v.hfov+P.hfov*i*.85)),p=e,0<i){P.yaw=.8*P.yaw+(v.yaw-o)/i*.2,P.pitch=.8*P.pitch+(v.pitch-a)/i*.2,P.hfov=.8*P.hfov+(v.hfov-n)/i*.2;var l=v.autoRotate?Math.abs(v.autoRotate):5;P.yaw=Math.min(l,Math.max(P.yaw,-l)),P.pitch=Math.min(l,Math.max(P.pitch,-l)),P.hfov=Math.min(l,Math.max(P.hfov,-l))}E[0]&&E[1]&&(P.hfov=0),(E[2]||E[6])&&(E[3]||E[7])&&(P.pitch=0),(E[4]||E[8])&&(E[5]||E[9])&&(P.yaw=0)}}(),0<=v.autoRotateInactivityDelay&&L&&Date.now()-m>v.autoRotateInactivityDelay&&!v.autoRotate&&(v.autoRotate=L,a.lookAt(d,Fe,s,3e3)),requestAnimationFrame(me);else if(g&&(g.isLoading()||!0===v.dynamic&&A))requestAnimationFrame(me);else{l=!1,p=Fe;var e=v.autoRotateInactivityDelay-(Date.now()-m);0<e?t=setTimeout(function(){v.autoRotate=L,a.lookAt(d,Fe,s,3e3),pe()},e):0<=v.autoRotateInactivityDelay&&L&&(v.autoRotate=L,a.lookAt(d,Fe,s,3e3),pe())}}function ve(e,t,a,o){this.w=e,this.x=t,this.y=a,this.z=o}function ge(e,t,a){var o,n,i,r,s,l,h=(o=e,i=a,r=[(n=t)?n*Math.PI/180/2:0,i?i*Math.PI/180/2:0,o?o*Math.PI/180/2:0],s=[Math.cos(r[0]),Math.cos(r[1]),Math.cos(r[2])],l=[Math.sin(r[0]),Math.sin(r[1]),Math.sin(r[2])],new ve(s[0]*s[1]*s[2]-l[0]*l[1]*l[2],l[0]*s[1]*s[2]-s[0]*l[1]*l[2],s[0]*l[1]*s[2]+l[0]*s[1]*l[2],s[0]*s[1]*l[2]+l[0]*l[1]*s[2]));h=h.multiply(new ve(Math.sqrt(.5),-Math.sqrt(.5),0,0));var c=Ne.orientation?-Ne.orientation*Math.PI/180/2:0;return h.multiply(new ve(Math.cos(c),0,-Math.sin(c),0))}function we(e){var t=ge(e.alpha,e.beta,e.gamma).toEulerAngles();"number"==typeof R&&R<10?R+=1:10===R?(_=t[2]/Math.PI*180+v.yaw,R=!0,requestAnimationFrame(me)):(v.pitch=t[0]/Math.PI*180,v.roll=-t[1]/Math.PI*180,v.yaw=-t[2]/Math.PI*180+_)}function ye(){if(v.sceneFadeDuration&&g.fadeImg!==Fe){g.fadeImg.style.opacity=0;var e=g.fadeImg;delete g.fadeImg,setTimeout(function(){O.removeChild(e),Oe("scenechangefadedone")},v.sceneFadeDuration)}v.compass?G.style.display="inline":G.style.display="none",function(){if(S)return;v.hotSpots?(v.hotSpots=v.hotSpots.sort(function(e,t){return e.pitch<t.pitch}),v.hotSpots.forEach(be)):v.hotSpots=[];S=!0,Me()}(),U.load.box.style.display="none",i!==Fe&&(O.removeChild(i),i=Fe),f=!0,Oe("load"),pe()}function be(t){t.pitch=Number(t.pitch)||0,t.yaw=Number(t.yaw)||0;var e=Ue.createElement("div");e.className="pnlm-hotspot-base",t.cssClass?e.className+=" "+t.cssClass:e.className+=" pnlm-hotspot pnlm-sprite pnlm-"+De(t.type);var a,o=Ue.createElement("span");if(t.text&&(o.innerHTML=De(t.text)),t.video){var n=Ue.createElement("video"),i=t.video;v.basePath&&!W(i)&&(i=v.basePath+i),n.src=encodeURI(i),n.controls=!0,n.style.width=t.width+"px",O.appendChild(e),o.appendChild(n)}else if(t.image){i=t.image;v.basePath&&!W(i)&&(i=v.basePath+i),(a=Ue.createElement("a")).href=encodeURI(t.URL?t.URL:i),a.target="_blank",o.appendChild(a);var r=Ue.createElement("img");r.src=encodeURI(i),r.style.width=t.width+"px",r.style.paddingTop="5px",O.appendChild(e),a.appendChild(r),o.style.maxWidth="initial"}else t.URL?((a=Ue.createElement("a")).href=encodeURI(t.URL),a.target="_blank",O.appendChild(a),e.style.cursor="pointer",o.style.cursor="pointer",a.appendChild(e)):(t.sceneId&&(e.onclick=e.ontouchend=function(){return e.clicked||(e.clicked=!0,Ae(t.sceneId,t.targetPitch,t.targetYaw,t.targetHfov)),!1},e.style.cursor="pointer",o.style.cursor="pointer"),O.appendChild(e));t.createTooltipFunc?t.createTooltipFunc(e,t.createTooltipArgs):(t.text||t.video||t.image)&&(e.classList.add("pnlm-tooltip"),e.appendChild(o),o.style.width=o.scrollWidth-20+"px",o.style.marginLeft=-(o.scrollWidth-e.offsetWidth)/2+"px",o.style.marginTop=-o.scrollHeight-12+"px"),t.clickHandlerFunc&&(e.addEventListener("click",function(e){t.clickHandlerFunc(e,t.clickHandlerArgs)},"false"),e.style.cursor="pointer",o.style.cursor="pointer"),t.div=e}function xe(e){var t=Math.sin(e.pitch*Math.PI/180),a=Math.cos(e.pitch*Math.PI/180),o=Math.sin(v.pitch*Math.PI/180),n=Math.cos(v.pitch*Math.PI/180),i=Math.cos((-e.yaw+v.yaw)*Math.PI/180),r=t*o+a*i*n;if(e.yaw<=90&&-90<e.yaw&&r<=0||(90<e.yaw||e.yaw<=-90)&&r<=0)e.div.style.visibility="hidden";else{var s=Math.sin((-e.yaw+v.yaw)*Math.PI/180),l=Math.tan(v.hfov*Math.PI/360);e.div.style.visibility="visible";var h=g.getCanvas(),c=h.clientWidth,d=h.clientHeight,u=[-c/l*s*a/r/2,-c/l*(t*n-a*i*o)/r/2],f=Math.sin(v.roll*Math.PI/180),p=Math.cos(v.roll*Math.PI/180);(u=[u[0]*p-u[1]*f,u[0]*f+u[1]*p])[0]+=(c-e.div.offsetWidth)/2,u[1]+=(d-e.div.offsetHeight)/2;var m="translate("+u[0]+"px, "+u[1]+"px) translateZ(9999px) rotate("+v.roll+"deg)";e.div.style.webkitTransform=m,e.div.style.MozTransform=m,e.div.style.transform=m}}function Me(){v.hotSpots.forEach(xe)}function Ee(e){var t,a;v={};var o=["haov","vaov","vOffset","northOffset","horizonPitch","horizonRoll"];for(t in C=[],k)k.hasOwnProperty(t)&&(v[t]=k[t]);for(t in c.default)if(c.default.hasOwnProperty(t))if("strings"==t)for(a in c.default.strings)c.default.strings.hasOwnProperty(a)&&(v.strings[a]=De(c.default.strings[a]));else v[t]=c.default[t],0<=o.indexOf(t)&&C.push(t);if(null!==e&&""!==e&&c.scenes&&c.scenes[e]){var n=c.scenes[e];for(t in n)if(n.hasOwnProperty(t))if("strings"==t)for(a in n.strings)n.strings.hasOwnProperty(a)&&(v.strings[a]=De(n.strings[a]));else v[t]=n[t],0<=o.indexOf(t)&&C.push(t);v.scene=e}for(t in c)if(c.hasOwnProperty(t))if("strings"==t)for(a in c.strings)c.strings.hasOwnProperty(a)&&(v.strings[a]=De(c.strings[a]));else v[t]=c[t],0<=o.indexOf(t)&&C.push(t)}function Pe(e){if((e=e||!1)&&"preview"in v){var t=v.preview;v.basePath&&!W(t)&&(t=v.basePath+t),(i=Ue.createElement("div")).className="pnlm-preview-img",i.style.backgroundImage="url('"+encodeURI(t)+"')",O.appendChild(i)}var a=v.title,o=v.author;for(var n in e&&("previewTitle"in v&&(v.title=v.previewTitle),"previewAuthor"in v&&(v.author=v.previewAuthor)),v.hasOwnProperty("title")||(U.title.innerHTML=""),v.hasOwnProperty("author")||(U.author.innerHTML=""),v.hasOwnProperty("title")||v.hasOwnProperty("author")||(U.container.style.display="none"),B.load.innerHTML="<p>"+v.strings.loadButtonLabel+"</p>",U.load.boxp.innerHTML=v.strings.loadingLabel,v)if(v.hasOwnProperty(n))switch(n){case"title":U.title.innerHTML=De(v[n]),U.container.style.display="inline";break;case"author":U.author.innerHTML=v.strings.bylineLabel.replace("%s",De(v[n])),U.container.style.display="inline";break;case"fallback":U.errorMsg.innerHTML='<p>Your browser does not support WebGL.<br><a href="'+encodeURI(v[n])+'" target="_blank">Click here to view this panorama in an alternative viewer.</a></p>';break;case"hfov":Te(Number(v[n]));break;case"autoLoad":!0===v[n]&&g===Fe&&(U.load.box.style.display="inline",B.load.style.display="none",Y());break;case"showZoomCtrl":v[n]&&0!=v.showControls?B.zoom.style.display="block":B.zoom.style.display="none";break;case"showFullscreenCtrl":v[n]&&0!=v.showControls&&("fullscreen"in Ue||"mozFullScreen"in Ue||"webkitIsFullScreen"in Ue||"msFullscreenElement"in Ue)?B.fullscreen.style.display="block":B.fullscreen.style.display="none";break;case"hotSpotDebug":v[n]?F.style.display="block":F.style.display="none";break;case"showControls":v[n]||(B.orientation.style.display="none",B.zoom.style.display="none",B.fullscreen.style.display="none");break;case"orientationOnByDefault":v[n]&&(z===Fe?H=!0:!0===z&&ke())}e&&(a?v.title=a:delete v.title,o?v.author=o:delete v.author)}function Re(){if(f&&!r)if(n)Ue.exitFullscreen?Ue.exitFullscreen():Ue.mozCancelFullScreen?Ue.mozCancelFullScreen():Ue.webkitCancelFullScreen?Ue.webkitCancelFullScreen():Ue.msExitFullscreen&&Ue.msExitFullscreen();else try{o.requestFullscreen?o.requestFullscreen():o.mozRequestFullScreen?o.mozRequestFullScreen():o.msRequestFullscreen?o.msRequestFullscreen():o.webkitRequestFullScreen()}catch(e){}}function _e(){Ue.fullscreen||Ue.mozFullScreen||Ue.webkitIsFullScreen||Ue.msFullscreenElement?(B.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),n=!0):(B.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),n=!1),g.resize(),Te(v.hfov),pe()}function Le(e){var t=v.minHfov;if("multires"==v.type&&g&&(t=Math.min(t,g.getCanvas().width/(v.multiRes.cubeResolution/90*.9))),t>v.maxHfov)return console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),v.hfov;var a=v.hfov;if(a=e<t?t:e>v.maxHfov?v.maxHfov:e,v.avoidShowingBackground&&g){var o=g.getCanvas();a=Math.min(a,360*Math.atan(Math.tan((v.maxPitch-v.minPitch)/360*Math.PI)/o.height*o.width)/Math.PI)}return a}function Te(e){v.hfov=Le(e)}function Ie(){T={},L=v.autoRotate?v.autoRotate:L,v.autoRotate=!1}function Ce(){r&&(U.load.box.style.display="none",U.errorMsg.style.display="none",r=!1,Oe("errorcleared")),f=!1,B.load.style.display="none",U.load.box.style.display="inline",Y()}function Ae(e,t,a,o,n){var i,r,s,l;if(f=!1,T={},v.sceneFadeDuration&&!n){var h=g.render(v.pitch*Math.PI/180,v.yaw*Math.PI/180,v.hfov*Math.PI/180,{returnImage:!0});if(h!==Fe)return(i=new Image).className="pnlm-fade-img",i.style.transition="opacity "+v.sceneFadeDuration/1e3+"s",i.style.width="100%",i.style.height="100%",i.onload=function(){Ae(e,t,a,o,!0)},i.src=h,O.appendChild(i),void(g.fadeImg=i)}r="same"===t?v.pitch:t,s="same"===a?v.yaw:"sameAzimuth"===a?v.yaw+(v.northOffset||0)-(c.scenes[e].northOffset||0):a,l="same"===o?v.hfov:o,function(){var e=v.hotSpots;if(S=!1,delete v.hotSpots,e)for(var t=0;t<e.length;t++){for(var a=e[t].div;a.parentNode!=O;)a=a.parentNode;O.removeChild(a),delete e[t].div}}(),Ee(e),P.yaw=P.pitch=P.hfov=0,Pe(),r!==Fe&&(v.pitch=r),s!==Fe&&(v.yaw=s),l!==Fe&&(v.hfov=l),Oe("scenechange",e),Ce()}function Se(){Ne.removeEventListener("deviceorientation",we),B.orientation.classList.remove("pnlm-orientation-button-active"),R=!1}function ke(){R=1,Ne.addEventListener("deviceorientation",we),B.orientation.classList.add("pnlm-orientation-button-active")}function De(e){return c.escapeHTML?String(e).split(/&/g).join("&amp;").split('"').join("&quot;").split("'").join("&#39;").split("<").join("&lt;").split(">").join("&gt;").split("/").join("&#x2f;").split("\n").join("<br>"):String(e).split("\n").join("<br>")}function Oe(e){if(e in I)for(var t=I[e].length;0<t;t--)I[e][I[e].length-t].apply(null,[].slice.call(arguments,1))}ve.prototype.multiply=function(e){return new ve(this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z,this.x*e.w+this.w*e.x+this.y*e.z-this.z*e.y,this.y*e.w+this.w*e.y+this.z*e.x-this.x*e.z,this.z*e.w+this.w*e.z+this.x*e.y-this.y*e.x)},ve.prototype.toEulerAngles=function(){return[Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),Math.asin(2*(this.w*this.y-this.z*this.x)),Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z))]},this.isLoaded=function(){return Boolean(f)},this.getPitch=function(){return v.pitch},this.setPitch=function(e,t,a,o){return(t=t==Fe?1e3:Number(t))?T.pitch={startTime:Date.now(),startPosition:v.pitch,endPosition:e,duration:t,callback:a,callbackArgs:o}:v.pitch=e,pe(),this},this.getPitchBounds=function(){return[v.minPitch,v.maxPitch]},this.setPitchBounds=function(e){return v.minPitch=Math.max(-90,Math.min(e[0],90)),v.maxPitch=Math.max(-90,Math.min(e[1],90)),this},this.getYaw=function(){return v.yaw},this.setYaw=function(e,t,a,o){return e=(e+180)%360-180,(t=t==Fe?1e3:Number(t))?(180<v.yaw-e?e+=360:180<e-v.yaw&&(e-=360),T.yaw={startTime:Date.now(),startPosition:v.yaw,endPosition:e,duration:t,callback:a,callbackArgs:o}):v.yaw=e,pe(),this},this.getYawBounds=function(){return[v.minYaw,v.maxYaw]},this.setYawBounds=function(e){return v.minYaw=Math.max(-180,Math.min(e[0],180)),v.maxYaw=Math.max(-180,Math.min(e[1],180)),this},this.getHfov=function(){return v.hfov},this.setHfov=function(e,t,a,o){return(t=t==Fe?1e3:Number(t))?T.hfov={startTime:Date.now(),startPosition:v.hfov,endPosition:Le(e),duration:t,callback:a,callbackArgs:o}:Te(e),pe(),this},this.getHfovBounds=function(){return[v.minHfov,v.maxHfov]},this.setHfovBounds=function(e){return v.minHfov=Math.max(0,e[0]),v.maxHfov=Math.max(0,e[1]),this},this.lookAt=function(e,t,a,o,n,i){return o=o==Fe?1e3:Number(o),e!==Fe&&(this.setPitch(e,o,n,i),n=Fe),t!==Fe&&(this.setYaw(t,o,n,i),n=Fe),a!==Fe&&this.setHfov(a,o,n,i),this},this.getNorthOffset=function(){return v.northOffset},this.setNorthOffset=function(e){return v.northOffset=Math.min(360,Math.max(0,e)),pe(),this},this.getHorizonRoll=function(){return v.horizonRoll},this.setHorizonRoll=function(e){return v.horizonRoll=Math.min(90,Math.max(-90,e)),g.setPose(v.horizonPitch*Math.PI/180,v.horizonRoll*Math.PI/180),pe(),this},this.getHorizonPitch=function(){return v.horizonPitch},this.setHorizonPitch=function(e){return v.horizonPitch=Math.min(90,Math.max(-90,e)),g.setPose(v.horizonPitch*Math.PI/180,v.horizonRoll*Math.PI/180),pe(),this},this.startAutoRotate=function(e){return e=e||L||1,v.autoRotate=e,a.lookAt(d,Fe,s,3e3),pe(),this},this.stopAutoRotate=function(){return L=v.autoRotate?v.autoRotate:L,v.autoRotate=!1,v.autoRotateInactivityDelay=-1,this},this.getRenderer=function(){return g},this.setUpdate=function(e){return A=!0===e,g===Fe?X():pe(),this},this.mouseEventToCoords=function(e){return K(e)},this.loadScene=function(e,t,a,o){return!1!==f&&Ae(e,t,a,o),this},this.getScene=function(){return v.scene},this.addScene=function(e,t){return c.scenes[e]=t,this},this.removeScene=function(e){return!(v.scene===e||!c.scenes.hasOwnProperty(e))&&(delete c.scenes[e],!0)},this.toggleFullscreen=function(){return Re(),this},this.getConfig=function(){return v},this.getContainer=function(){return o},this.addHotSpot=function(e,t){if(t===Fe&&v.scene===Fe)v.hotSpots.push(e);else{var a=t!==Fe?t:v.scene;if(!c.scenes.hasOwnProperty(a))throw"Invalid scene ID!";c.scenes[a].hasOwnProperty("hotSpots")||(c.scenes[a].hotSpots=[],a==v.scene&&(v.hotSpots=c.scenes[a].hotSpots)),c.scenes[a].hotSpots.push(e)}return t!==Fe&&v.scene!=t||(be(e),f&&xe(e)),this},this.removeHotSpot=function(e){if(!v.hotSpots)return!1;for(var t=0;t<v.hotSpots.length;t++)if(v.hotSpots[t].hasOwnProperty("id")&&v.hotSpots[t].id===e){for(var a=v.hotSpots[t].div;a.parentNode!=O;)a=a.parentNode;return O.removeChild(a),delete v.hotSpots[t].div,v.hotSpots.splice(t,1),!0}return!1},this.resize=function(){fe()},this.isLoaded=function(){return f},this.isOrientationSupported=function(){return z||!1},this.stopOrientation=function(){Se()},this.startOrientation=function(){z&&ke()},this.isOrientationActive=function(){return Boolean(R)},this.on=function(e,t){return I[e]=I[e]||[],I[e].push(t),this},this.off=function(e,t){if(!e)return I={},this;if(t){var a=I[e].indexOf(t);0<=a&&I[e].splice(a,1),0==I[e].length&&delete I[e]}else delete I[e];return this},this.destroy=function(){g&&g.destroy(),e&&(N.removeEventListener("mousedown",j,!1),N.removeEventListener("dblclick",V,!1),Ue.removeEventListener("mousemove",J,!1),Ue.removeEventListener("mouseup",Q,!1),o.removeEventListener("mousewheel",se,!1),o.removeEventListener("DOMMouseScroll",se,!1),o.removeEventListener("mozfullscreenchange",_e,!1),o.removeEventListener("webkitfullscreenchange",_e,!1),o.removeEventListener("msfullscreenchange",_e,!1),o.removeEventListener("fullscreenchange",_e,!1),Ne.removeEventListener("resize",fe,!1),Ne.removeEventListener("orientationchange",fe,!1),o.removeEventListener("keydown",le,!1),o.removeEventListener("keyup",ce,!1),o.removeEventListener("blur",he,!1),Ue.removeEventListener("mouseleave",Q,!1),N.removeEventListener("touchstart",$,!1),N.removeEventListener("touchmove",ee,!1),N.removeEventListener("touchend",te,!1),N.removeEventListener("pointerdown",ne,!1),N.removeEventListener("pointermove",ie,!1),N.removeEventListener("pointerup",re,!1),N.removeEventListener("pointerleave",re,!1)),o.innerHTML="",o.classList.remove("pnlm-container"),D.classList.remove("pnlm-grab"),D.classList.remove("pnlm-grabbing")}}return{viewer:function(e,t){return new a(e,t)}}}(window,document);